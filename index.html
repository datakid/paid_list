<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LX Search P2.2</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600&family=Cormorant+Garamond:ital,wght@0,400;0,500;0,600;0,700;1,400&family=Inter:wght@300;400;500&family=Prata&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        :root {
            --lx-gold: linear-gradient(135deg, #a8854e 0%, #c5a47e 25%, #d4b896 50%, #c5a47e 75%, #9f7944 100%);
            --lx-gold-solid: #b08d57;
            --lx-gold-light: #c5a47e;
            --lx-gold-dark: #9a7c4a;
            --lx-gold-text: linear-gradient(135deg, #e8d5b7 0%, #c5a47e 30%, #b08d57 70%, #9a7c4a 100%);
            --lx-gold-glow: rgba(176, 141, 87, 0.25);
            --lx-gold-glow-intense: rgba(197, 164, 126, 0.4);
            --lx-shine-color-center: rgba(232, 213, 183, 0.1);
            --lx-shine-color-edge: rgba(197, 164, 126, 0.03);
            --lx-dark-bg: radial-gradient(ellipse at center, #0a0a0a 0%, #030303 100%);
            --lx-element-bg: linear-gradient(145deg, #161616 0%, #0a0a0a 100%);
            --lx-element-bg-hover: linear-gradient(145deg, #1f1f1f 0%, #101010 100%);
            --lx-text-light: #f0f0f0;
            --lx-text-dark: #1c1c1c;
            --lx-text-placeholder: #7c7c7c;
            --lx-reset-button-bg: linear-gradient(135deg, #303030 0%, #222222 100%);
            --lx-reset-button-text: #c0c0c0;
            --lx-reset-button-border: #4f4f4f;

            --font-logo: 'Cinzel', serif;
            --font-display: 'Cormorant Garamond', serif;
            --font-body: 'Inter', sans-serif;
            --font-price: 'Prata', serif;
            --border-radius-main: 22px;
            --border-radius-elements: 28px;
            --shadow-ultra: 0 15px 60px rgba(0,0,0, 0.6), 0 8px 30px rgba(176, 141, 87, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.02);
            --shadow-mega: 0 25px 90px rgba(0,0,0, 0.7), 0 15px 50px rgba(176, 141, 87, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.04);
            --shadow-divine: 0 40px 130px rgba(0,0,0, 0.8), 0 20px 70px rgba(176, 141, 87, 0.25), inset 0 2px 0 rgba(255, 255, 255, 0.06);
        }
        
        @keyframes fadeInMajestic {
            from { opacity: 0; transform: translateY(35px) scale(0.96); filter: blur(4px); }
            to { opacity: 1; transform: translateY(0) scale(1); filter: blur(0px); }
        }
        
        @keyframes pulseGoldBorderDivine {
            0% { border-color: var(--lx-gold-dark); box-shadow: inset 0 0 20px var(--lx-gold-glow), 0 0 15px var(--lx-gold-glow), 0 0 40px rgba(176, 141, 87, 0.15); }
            50% { border-color: var(--lx-gold-light); box-shadow: inset 0 0 30px var(--lx-gold-glow-intense), 0 0 25px var(--lx-gold-glow-intense), 0 0 60px rgba(197, 164, 126, 0.25); }
            100% { border-color: var(--lx-gold-dark); box-shadow: inset 0 0 20px var(--lx-gold-glow), 0 0 15px var(--lx-gold-glow), 0 0 40px rgba(176, 141, 87, 0.15); }
        }

        @keyframes shimmerMajestic {
            0% { transform: translateX(-150%) skewX(-15deg); opacity: 0; }
            30% { opacity: 1; }
            70% { opacity: 1; }
            100% { transform: translateX(250%) skewX(-15deg); opacity: 0; }
        }

        @keyframes floatMajestic {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-6px); }
        }

        @keyframes breathe {
            0%, 100% { transform: scale(1); opacity: 0.7; }
            50% { transform: scale(1.03); opacity: 1; }
        }

        body, html { 
            margin: 0; padding: 0; font-family: var(--font-body); background: var(--lx-dark-bg); color: var(--lx-text-light); min-height: 100vh; overflow-x: hidden; font-size: 16px; line-height: 1.9; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; position: relative;
        }

        body::before {
            content: ""; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at 15% 85%, rgba(176, 141, 87, 0.02) 0%, transparent 50%), radial-gradient(circle at 85% 15%, rgba(197, 164, 126, 0.02) 0%, transparent 50%);
            pointer-events: none; z-index: -1;
        }

        body::after {
            content: ""; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: repeating-linear-gradient(0deg, transparent, transparent 1px, rgba(176, 141, 87, 0.01) 1px, rgba(176, 141, 87, 0.01) 3px);
            pointer-events: none; z-index: -1; opacity: 0.15;
        }

        .app-container { width: 100%; max-width: 1100px; margin: 0 auto; padding: 60px 25px; min-height: 100vh; display: flex; flex-direction: column; animation: fadeInMajestic 1.4s cubic-bezier(0.23, 1, 0.32, 1); }
        .app-header { background: var(--lx-element-bg); padding: 40px; border-radius: var(--border-radius-main); margin-bottom: 40px; box-shadow: var(--shadow-mega); border: 1px solid rgba(176, 141, 87, 0.2); position: relative; overflow: hidden; backdrop-filter: blur(15px); }

        .app-header::before {
            content: ""; position: absolute; top: 0; left: -150%; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(232, 213, 183, 0.03) 30%, rgba(197, 164, 126, 0.05) 50%, rgba(232, 213, 183, 0.03) 70%, transparent);
            animation: shimmerMajestic 7s infinite 1.5s;
        }

        .app-header::after {
            content: ""; position: absolute; top: 0; left: 0; right: 0; height: 1px;
            background: linear-gradient(90deg, transparent, var(--lx-gold-light) 30%, var(--lx-gold-solid) 50%, var(--lx-gold-light) 70%, transparent); opacity: 0.3;
        }

        .header-top { display: flex; justify-content: center; align-items: center; margin-bottom: 35px; position: relative; z-index: 1; }

        .logo { 
            font-family: var(--font-logo); font-size: 3.2em; font-weight: 500; background: var(--lx-gold-text); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            letter-spacing: 5px; display: flex; align-items: center; text-shadow: 0 0 50px rgba(176, 141, 87, 0.3); animation: floatMajestic 10s ease-in-out infinite; position: relative; text-transform: uppercase;
        }

        .logo::before {
            content: ""; position: absolute; top: -15px; left: -15px; right: -15px; bottom: -15px;
            background: radial-gradient(circle, rgba(176, 141, 87, 0.07) 0%, transparent 65%); border-radius: 50%; animation: breathe 6s ease-in-out infinite; z-index: -1;
        }

        .logo i.fa-gem { margin-right: 22px; font-size: 0.8em; color: var(--lx-gold-solid); filter: drop-shadow(0 0 15px rgba(176, 141, 87, 0.5)); animation: floatMajestic 10s ease-in-out infinite reverse; }
        .search-wrapper { position: relative; width: 100%; max-width: 700px; margin: 0 auto 30px auto; }

        #searchInput { 
            width: 100%; padding: 18px 28px 18px 60px; font-size: 1.15em; font-family: var(--font-body); font-weight: 400; border: 1px solid var(--lx-gold-dark); border-radius: var(--border-radius-elements); 
            background: var(--lx-element-bg); color: var(--lx-text-light); outline: none; transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1); 
            box-shadow: inset 0 0 15px rgba(176, 141, 87, 0.08), 0 10px 30px rgba(0,0,0,0.5); position: relative; z-index: 1; backdrop-filter: blur(10px);
        }

        #searchInput:focus { animation: pulseGoldBorderDivine 5s infinite ease-in-out; background: var(--lx-element-bg-hover); transform: scale(1.02); font-weight: 500; }
        #searchInput::placeholder { color: var(--lx-text-placeholder); font-weight: 300; font-style: italic; opacity: 0.9; }
        .search-icon { position: absolute; left: 24px; top: 50%; transform: translateY(-50%); color: var(--lx-text-placeholder); font-size: 1.2em; pointer-events: none; transition: all 0.5s ease; z-index: 2; }
        #searchInput:focus + .search-icon { color: var(--lx-gold-solid); filter: drop-shadow(0 0 10px rgba(176, 141, 87, 0.7)); transform: translateY(-50%) scale(1.1); }
        .filter-area { display: flex; gap: 15px; flex-wrap: wrap; justify-content: center; position: relative; z-index: 1; }

        .filter-select, .filter-btn-reset { 
            background: var(--lx-gold); border: 1px solid var(--lx-gold-dark); color: var(--lx-text-dark); padding: 10px 25px; border-radius: var(--border-radius-elements); cursor: pointer;
            font-size: 0.9em; font-weight: 600; font-family: var(--font-body); transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3), 0 0 15px rgba(176, 141, 87, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.25);
            letter-spacing: 0.5px; display: flex; align-items: center; position: relative; overflow: hidden; backdrop-filter: blur(5px);
        }

        .filter-select::before, .filter-btn-reset::before {
            content: ""; position: absolute; top: 0; left: -120%; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.15) 30%, rgba(255, 255, 255, 0.25) 50%, rgba(255, 255, 255, 0.15) 70%, transparent);
            transition: left 0.8s ease;
        }

        .filter-select:hover::before, .filter-btn-reset:hover::before { left: 120%; }
        .filter-select { appearance: none; -webkit-appearance: none; -moz-appearance: none; padding-right: 45px; }
        .filter-select::after { content: '\f078'; font-family: 'Font Awesome 6 Free'; font-weight: 900; font-size: 0.8em; position: absolute; right: 18px; color: var(--lx-text-dark); transition: transform 0.4s ease; pointer-events: none; }
        .filter-select:focus::after { transform: rotate(180deg); }
        .filter-select option { background: #2a2a2a; color: var(--lx-gold-light); font-weight: 500; padding: 12px; border-radius: 8px; }

        .filter-select:hover, .filter-btn-reset:hover { 
            transform: translateY(-4px); box-shadow: 0 15px 35px rgba(0,0,0,0.4), 0 0 30px rgba(176, 141, 87, 0.4), inset 0 2px 0 rgba(255, 255, 255, 0.3);
            filter: brightness(1.1) saturate(1.1); border-color: var(--lx-gold-light);
        }

        .filter-btn-reset { background: var(--lx-reset-button-bg); color: var(--lx-reset-button-text); border: 1px solid var(--lx-reset-button-border); }
        .filter-btn-reset:hover { background: linear-gradient(135deg, #444444 0%, #333333 100%); color: var(--lx-text-light); border-color: #777777; }
        .app-main { flex-grow: 1; position: relative; padding-top: 20px; }

        .suggestions-area {
            margin: 0 auto 30px auto; max-width: calc(100% - 50px); width: fit-content; padding: 15px 25px; background: var(--lx-element-bg); border-radius: 14px;
            border: 1px solid rgba(176, 141, 87, 0.2); font-size: 1.05em; color: var(--lx-text-placeholder); text-align: left; box-shadow: var(--shadow-ultra);
            animation: fadeInMajestic 0.6s ease-out; position: relative; overflow: hidden;
        }

        .suggestions-area::before {
            content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 1px;
            background: linear-gradient(90deg, transparent, var(--lx-gold-light) 20%, var(--lx-gold-solid) 50%, var(--lx-gold-light) 80%, transparent); opacity: 0.5;
        }

        .suggestions-area:empty { display: none; }
        .suggestions-area p { margin: 0; display: flex; align-items: center; flex-wrap: wrap; gap: 5px 10px; }
        .suggestions-area strong { font-weight: 500; color: var(--lx-text-light); margin-right: 8px; font-style: italic; }
        .suggestions-area a { 
            color: var(--lx-gold-solid); text-decoration: none; font-weight: 500; padding: 3px 10px; border-radius: 6px; transition: all 0.4s ease;
            display: inline-block; border: 1px solid transparent; position: relative; overflow: hidden; z-index: 1; font-family: var(--font-display);
        }

        .suggestions-area a::before { content: ""; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: var(--lx-gold); transition: left 0.4s ease; z-index: -1; }
        .suggestions-area a:hover::before { left: 0; }
        .suggestions-area a:hover { color: var(--lx-text-dark); text-decoration: none; border-color: rgba(255, 255, 255, 0.2); box-shadow: 0 4px 12px rgba(176, 141, 87, 0.3); }
        .results-area { display: grid; grid-template-columns: repeat(auto-fill, minmax(340px, 1fr)); gap: 35px; }

        .results-area .placeholder-text {
            color: var(--lx-text-placeholder); text-align: center; font-size: 1.5em; margin-top: 80px; grid-column: 1 / -1;
            font-weight: 400; font-style: italic; opacity: 0.6; font-family: var(--font-display);
        }

        .result-item {
            background: var(--lx-element-bg); border: 1px solid rgba(176, 141, 87, 0.2); border-radius: 16px; padding: 30px; box-shadow: var(--shadow-ultra);
            transition: all 0.6s cubic-bezier(0.23, 1, 0.32, 1); position: relative; overflow: hidden; display: flex; flex-direction: column; backdrop-filter: blur(10px);
        }

        .result-item::before { 
            content: ""; position: absolute; top: -50%; left: -250%; width: 100%; height: 200%;
            background: linear-gradient(50deg, transparent 0%, var(--lx-shine-color-edge) 20%, var(--lx-shine-color-center) 50%, var(--lx-shine-color-edge) 80%, transparent 100%);
            transform: skewX(-15deg); transition: left 1.5s cubic-bezier(0.165, 0.84, 0.44, 1); opacity: 0; z-index: 1;
        }

        .result-item::after { content: ""; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, rgba(176, 141, 87, 0.05) 0%, transparent 50%); opacity: 0; transition: opacity 0.6s ease; z-index: 0; }
        .result-item:hover::before { left: 150%; opacity: 0.7; transition-duration: 1.8s; }
        .result-item:hover::after { opacity: 1; }
        .result-item:hover { transform: translateY(-12px); box-shadow: var(--shadow-divine); border-color: var(--lx-gold-solid); background: var(--lx-element-bg-hover); }
        .item-header { margin-bottom: 15px; z-index: 2; position: relative; flex-grow: 1; }
        .item-name { font-family: var(--font-display); font-size: 1.9em; font-weight: 600; background: var(--lx-gold-text); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 12px; line-height: 1.3; text-shadow: 0 0 20px rgba(176, 141, 87, 0.3); }
        .item-details { font-size: 1em; color: var(--lx-text-placeholder); font-weight: 400; z-index: 2; position: relative; line-height: 1.8; }
        .item-details strong { color: var(--lx-text-light); font-weight: 500; }
        .item-details p { margin: 0 0 6px 0; }
        .item-details .source-arabic { font-family: 'Arial', sans-serif; }
        .item-price-wrapper { margin-top: 20px; text-align: right; z-index: 2; position: relative; }

        .price { 
            font-family: var(--font-price); font-weight: 400; background: var(--lx-gold-text); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            font-size: 2.2em; text-shadow: 0 0 25px rgba(176, 141, 87, 0.4); letter-spacing: 1px; display: inline-block;
        }

        @media (max-width: 768px) { 
            .app-container { padding: 40px 20px; } 
            .app-header { padding: 30px 25px; margin-bottom: 30px; } 
            .logo { font-size: 2.5em; } 
            #searchInput { padding: 18px 25px 18px 55px; font-size: 1.1em; } 
            .search-icon { left: 20px; font-size: 1.2em; } 
            .filter-area { gap: 12px; } 
            .filter-select, .filter-btn-reset { padding: 10px 22px; font-size: 0.9em; } 
            .results-area { grid-template-columns: 1fr; gap: 30px; } 
            .item-name { font-size: 1.7em; } 
            .price { font-size: 2em; }
        }

        @media (max-width: 480px) { 
            .logo { font-size: 2.1em; letter-spacing: 3px; } 
            .filter-select, .filter-btn-reset { width: 100%; text-align: left; justify-content: space-between; } 
            .filter-select { padding-right: 25px; } 
            .filter-select::after { right: 18px; } 
            .item-name { font-size: 1.6em; } 
            .item-details { font-size: 0.95em; }
            .price { font-size: 1.9em; }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header class="app-header">
            <div class="header-top">
                <div class="logo">
                    <i class="fas fa-gem"></i> LX Search P2.2
                </div>
            </div>
            <div class="search-wrapper">
                 <input type="text" id="searchInput" placeholder="Search the Élite Collection...">
                 <i class="fas fa-search search-icon"></i>
            </div>
            <div class="filter-area">
                <select id="unitFilter" class="filter-select">
                    <option value="all">All Units</option>
                </select>
                <select id="companyFilter" class="filter-select">
                    <option value="all">All Sources</option>
                </select>
                 <button id="resetFilters" class="filter-btn-reset">Reset</button>
            </div>
        </header>

        <main class="app-main">
            <div id="suggestionsArea" class="suggestions-area"></div>
            <div id="resultsArea" class="results-area">
                <p class="placeholder-text">Begin your search to unveil the collection...</p>
            </div>
        </main>
    </div>
</body>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const searchInput = document.getElementById('searchInput');
        const unitFilterSelect = document.getElementById('unitFilter');
        const companyFilterSelect = document.getElementById('companyFilter');
        const resetFiltersBtn = document.getElementById('resetFilters');
        const resultsArea = document.getElementById('resultsArea');
        const suggestionsArea = document.getElementById('suggestionsArea');
        let searchTimeout;

        const allMasterItemsRaw = [
            {name: "Amaryl 1", unit: "30 Tab", price: 11.5, company: "شراء موحد"}, {name: "Amaryl 2", unit: "30 Tab", price: 27, company: "شراء موحد"}, {name: "Amaryl 3", unit: "30 Tab", price: 30, company: "شراء موحد"}, {name: "Amaryl 4", unit: "30 Tab", price: 37.5, company: "شراء موحد"}, {name: "Amaryl M", unit: "30 Tab", price: 26.5, company: "شراء موحد"}, {name: "Apidra قوي عاملة", unit: "Penfill", price: 44, company: "شراء موحد"}, {name: "Apidra طلاب", unit: "Penfill", price: 20, company: "شراء موحد"}, {name: "Atacand 16", unit: "14 Tab", price: 38.5, company: "شراء موحد"}, {name: "Atacand 16 plus", unit: "14 Tab", price: 42, company: "شراء موحد"}, {name: "Atacand 8", unit: "14 Tab", price: 27, company: "شراء موحد"}, {name: "Atozet 10 / 10", unit: "10 Tab", price: 96, company: "شراء موحد"}, {name: "Atozet 20 / 10", unit: "10 Tab", price: 110, company: "شراء موحد"}, {name: "Brilique 60", unit: "56 Tab", price: 100, company: "ايرادات هيئة"}, {name: "Brilique 90", unit: "56 Tab", price: 100, company: "ايرادات هيئة"}, {name: "Campto", unit: "Vial", price: 60, company: "شراء موحد"}, {name: "Cardura 1", unit: "21 Tab", price: 23, company: "شراء موحد"}, {name: "Cardura 4", unit: "14 Tab", price: 31, company: "شراء موحد"}, {name: "Carnvita forte", unit: "30 Tab", price: 20, company: "شراء موحد"}, {name: "Celebrex 200", unit: "10 Tab", price: 51.5, company: "شراء موحد"}, {name: "Concor 2.5", unit: "30 Tab", price: 10, company: "شراء موحد"}, {name: "Concor 5", unit: "30 Tab", price: 26, company: "شراء موحد"}, {name: "Cosopt", unit: "Bottle", price: 52, company: "شراء موحد"}, {name: "Coveram 10 /10", unit: "15 Tab", price: 65, company: "شراء موحد"}, {name: "Coveram 5 / 5", unit: "15 Tab", price: 48, company: "شراء موحد"}, {name: "Coversyl 10 plus", unit: "15 Tab", price: 20, company: "شراء موحد"}, {name: "Coversyl 5", unit: "30 Tab", price: 53, company: "شراء موحد"}, {name: "Coversyl 5 plus", unit: "15 Tab", price: 30.5, company: "شراء موحد"}, {name: "Cozaar 50", unit: "7 Tab", price: 22.25, company: "شراء موحد"}, {name: "Crestor 10", unit: "28 Tab", price: 118, company: "شراء موحد"}, {name: "Crestor 20", unit: "14 Tab", price: 96, company: "شراء موحد"}, {name: "Crestor 5", unit: "7 Tab", price: 18, company: "شراء موحد"}, {name: "Daflon 500", unit: "30 Tab", price: 30, company: "شراء موحد"}, {name: "Daivobet", unit: "Tube", price: 20, company: "شراء موحد"}, {name: "Depakine Ch 500", unit: "30 Tab", price: 45, company: "شراء موحد"}, {name: "Depakine Syrup", unit: "Bottle", price: 16, company: "شراء موحد"}, {name: "Diamicron 30 Mr", unit: "30 Tab", price: 16, company: "شراء موحد"}, {name: "Diamicron 60 Mr", unit: "30 Tab", price: 20, company: "شراء موحد"}, {name: "Diamicron 80", unit: "20 Tab", price: 9, company: "شراء موحد"}, {name: "Dorofen", unit: "30 Cap", price: 10, company: "شراء موحد"}, {name: "Dostinex", unit: "2 Tab", price: 54.25, company: "شراء موحد"}, {name: "Eliquis 2.5", unit: "20 Tab", price: 50, company: "ايرادات هيئة"}, {name: "Eliquis 5", unit: "20 Tab", price: 50, company: "ايرادات هيئة"}, {name: "Eloxatin 100", unit: "Vial", price: 800, company: "شراء موحد"}, {name: "Eloxatin 50", unit: "Vial", price: 500, company: "شراء موحد"}, {name: "Entresto 100", unit: "28 Tab", price: 50, company: "ايرادات هيئة"}, {name: "Entresto 200", unit: "28 Tab", price: 50, company: "ايرادات هيئة"}, {name: "Entresto 50", unit: "28 Tab", price: 50, company: "ايرادات هيئة"}, {name: "Etodolac 600", unit: "10 Tab", price: 15.5, company: "شراء موحد"}, {name: "Exforge Hct 160 / 10 / 25", unit: "14 Tab", price: 70.5, company: "شراء موحد"}, {name: "Exforge Hct 160 / 5 /12.5", unit: "14 Tab", price: 73.5, company: "شراء موحد"}, {name: "Femara 2.5", unit: "30 Tab", price: 52.59, company: "شراء موحد"}, {name: "Flagyl 250", unit: "20 Tab", price: 5.5, company: "شراء موحد"}, {name: "Foradil", unit: "30 Cap", price: 75, company: "شراء موحد"}, {name: "Forxiga 10", unit: "28 Tab", price: 222, company: "شراء موحد"}, {name: "Forxiga 5", unit: "28 Tab", price: 234, company: "شراء موحد"}, {name: "Galvus 50", unit: "28 Tab", price: 65, company: "شراء موحد"}, {name: "Galvus Met 50 / 1000", unit: "30 Tab", price: 86.5, company: "شراء موحد"}, {name: "Galvus Met 50 / 850", unit: "30 Tab", price: 79.5, company: "شراء موحد"}, {name: "Genuphil", unit: "50 Tab", price: 20, company: "شراء موحد"}, {name: "Glucophage 1000", unit: "30 Tab", price: 12.5, company: "شراء موحد"}, {name: "Glucophage 500", unit: "50 Tab", price: 14.5, company: "شراء موحد"}, {name: "Glucophage Xr 1000", unit: "30 Tab", price: 42.5, company: "شراء موحد"}, {name: "Glucovance 5 / 500", unit: "30 Tab", price: 26.5, company: "شراء موحد"}, {name: "Glucovance 5 /1000", unit: "30 Tab", price: 20, company: "شراء موحد"}, {name: "Humalog 100 pen قوي عاملة", unit: "Pen", price: 52.87, company: "شراء موحد"}, {name: "Humalog 100 penfill قوي عاملة", unit: "Penfill", price: 48, company: "شراء موحد"}, {name: "Humalog Mix 25 قوي عاملة", unit: "Pen", price: 60, company: "شراء موحد"}, {name: "Humalog Mix 25 طلاب", unit: "Pen", price: 20, company: "شراء موحد"}, {name: "Humalog Mix 50 قوي عاملة", unit: "Pen", price: 60, company: "شراء موحد"}, {name: "Humalog Mix 50 طلاب", unit: "Pen", price: 20, company: "شراء موحد"}, {name: "Hyzaar 50", unit: "7 Tab", price: 22, company: "شراء موحد"}, {name: "Isoptin 80", unit: "30 Tab", price: 6.5, company: "شراء موحد"}, {name: "Januvia 100", unit: "28 Tab", price: 193, company: "شراء موحد"}, {name: "Januvia 50", unit: "28 Tab", price: 165, company: "شراء موحد"}, {name: "Jaunamet 50 / 1000", unit: "56 Tab", price: 195, company: "شراء موحد"}, {name: "Jaunamet 50 / 500", unit: "56 Tab", price: 204, company: "شراء موحد"}, {name: "Jaunamet 50 / 850", unit: "56 Tab", price: 175, company: "شراء موحد"}, {name: "Lasilactone 50 / 20", unit: "30 Tab", price: 8, company: "شراء موحد"}, {name: "Lantus", unit: "Penfill", price: 20, company: "ايرادات هيئة"}, {name: "Lasix 40", unit: "24 Tab", price: 9, company: "شراء موحد"}, {name: "Lipanthyl 300", unit: "30 Tab", price: 26, company: "شراء موحد"}, {name: "Lipitor 10", unit: "7 Tab", price: 28.5, company: "شراء موحد"}, {name: "Lipitor 20", unit: "7 Tab", price: 32, company: "شراء موحد"}, {name: "Lipitor 40", unit: "7 Tab", price: 46.5, company: "شراء موحد"}, {name: "Lipiror 80", unit: "7 Tab", price: 51, company: "شراء موحد"}, {name: "Lustral 50", unit: "7 Tab", price: 26.5, company: "شراء موحد"}, {name: "Mena Q", unit: "20 Cap", price: 37, company: "شراء موحد"}, {name: "Methyltechno", unit: "30 Film", price: 12, company: "شراء موحد"}, {name: "Natrilix Sr", unit: "30 Tab", price: 16, company: "شراء موحد"}, {name: "Natrixam 1.5 / 10", unit: "28 Tab", price: 43, company: "شراء موحد"}, {name: "Natrixam 1.5 / 5", unit: "28 Tab", price: 43, company: "شراء موحد"}, {name: "Nebicard 5", unit: "14 Tab", price: 13, company: "شراء موحد"}, {name: "Nexium 20", unit: "28 Tab", price: 140, company: "شراء موحد"}, {name: "Norditropine", unit: "Pen", price: 30, company: "شراء موحد"}, {name: "Norvasc 10", unit: "10 Tab", price: 25.5, company: "شراء موحد"}, {name: "Norvasc 5", unit: "10 Tab", price: 23.5, company: "شراء موحد"}, {name: "Novomix 30 Mix قوي عاملة", unit: "Pen", price: 60, company: "شراء موحد"}, {name: "Novomix 30 Mix طلاب", unit: "Pen", price: 20, company: "شراء موحد"}, {name: "Novomix 50 Mix قوي عاملة", unit: "Pen", price: 60, company: "شراء موحد"}, {name: "Novomix 50 Mix طلاب", unit: "Pen", price: 20, company: "شراء موحد"}, {name: "Novorapid قوي عاملة", unit: "Penfill", price: 39.5, company: "شراء موحد"}, {name: "Novorapid طلاب", unit: "Penfill", price: 20, company: "شراء موحد"}, {name: "Orthoglobe", unit: "30 Tab", price: 10, company: "شراء موحد"}, {name: "Plavix 75", unit: "28 Tab", price: 40, company: "ايرادات هيئة"}, {name: "Plendil 5", unit: "30 Tab", price: 33, company: "شراء موحد"}, {name: "Pletaal 100", unit: "20 Tab", price: 64, company: "شراء موحد"}, {name: "Pletaal 50", unit: "20 Tab", price: 44.5, company: "شراء موحد"}, {name: "Procorolan 5", unit: "28 Tab", price: 50, company: "شراء موحد"}, {name: "Procorolan 7.5", unit: "28 Tab", price: 50, company: "شراء موحد"}, {name: "Ryzodec", unit: "Pen", price: 100, company: "شراء موحد"}, {name: "Singulair 10", unit: "14 Tab", price: 84.5, company: "شراء موحد"}, {name: "Singulair 5", unit: "14 Tab", price: 77.75, company: "شراء موحد"}, {name: "Soliqua 100 / 33", unit: "Pen", price: 162, company: "شراء موحد"}, {name: "Soliqua 100 / 50", unit: "Pen", price: 287, company: "شراء موحد"}, {name: "Tareg 40", unit: "15 Tab", price: 49, company: "شراء موحد"}, {name: "Tarolimus", unit: "Tube", price: 15, company: "شراء موحد"}, {name: "Taxoter 20", unit: "Vial", price: 240, company: "شراء موحد"}, {name: "Taxoter 80", unit: "Vial", price: 860, company: "شراء موحد"}, {name: "Tegretol 200", unit: "30 Tab", price: 13, company: "شراء موحد"}, {name: "Tegretol 200 Cr", unit: "20 Tab", price: 7.5, company: "شراء موحد"}, {name: "Tegretol 400 Cr", unit: "20 Tab", price: 9, company: "شراء موحد"}, {name: "Tenormin 100", unit: "14 Tab", price: 9.5, company: "شراء موحد"}, {name: "Tenormin 50", unit: "14 Tab", price: 7.25, company: "شراء موحد"}, {name: "Tentavair 160", unit: "Spray", price: 27, company: "شراء موحد"}, {name: "Toujeo قوي عاملة", unit: "Pen", price: 50, company: "شراء موحد"}, {name: "Toujeo طلاب", unit: "Pen", price: 15, company: "شراء موحد"}, {name: "Tresiba قوي عاملة", unit: "Pen", price: 70, company: "شراء موحد"}, {name: "Tresiba طلاب", unit: "Pen", price: 25, company: "شراء موحد"}, {name: "Trilepital 300", unit: "50 Tab", price: 116.25, company: "شراء موحد"}, {name: "Tritace 2.5", unit: "14 Tab", price: 14.5, company: "شراء موحد"}, {name: "Tritace 5", unit: "14 Tab", price: 19, company: "شراء موحد"}, {name: "Tritace comp 5 / 25", unit: "14 Tab", price: 27, company: "شراء موحد"}, {name: "Tritace Comp Ls 2.5 / 12.5", unit: "14 Tab", price: 18, company: "شراء موحد"}, {name: "Tritace Protect 10", unit: "20 Tab", price: 29, company: "شراء موحد"}, {name: "Trivastal", unit: "30 Tab", price: 27.25, company: "شراء موحد"}, {name: "Vastarel Mr", unit: "30 Tab", price: 48.5, company: "شراء موحد"}, {name: "Xarelto 10", unit: "10 Tab", price: 50, company: "ايرادات هيئة"}, {name: "Xarelto 15", unit: "42 Tab", price: 210, company: "ايرادات هيئة"}, {name: "Xarelto 20", unit: "28 Tab", price: 140, company: "ايرادات هيئة"}, {name: "Xigduo 5 /1000", unit: "56 Tab", price: 98.5, company: "شراء موحد"}, {name: "Zestril 5", unit: "10 Tab", price: 6.25, company: "شراء موحد"}, {name: "Zestril 10", unit: "10 Tab", price: 7.5, company: "شراء موحد"}, {name: "Zestril 20", unit: "10 Tab", price: 8.5, company: "شراء موحد"}, {name: "Zocor 10", unit: "7 Tab", price: 22.75, company: "شراء موحد"}, {name: "Zocor 20", unit: "14 Tab", price: 60.5, company: "شراء موحد"}, {name: "Zocor 40", unit: "14 Tab", price: 57, company: "شراء موحد"}
        ];

        const preserveSuffixes = ["قوي عاملة", "طلاب"]; 

        const translateCompanyToEnglish = (arabicCompany) => {
            if (arabicCompany === "شراء موحد") return "Unified Purchase";
            if (arabicCompany === "ايرادات هيئة") return "Authority Revenue";
            return arabicCompany; 
        };
        
        const processItemName = (originalName) => {
            let baseName = originalName;
            let preservedSuffix = "";

            for (const suffix of preserveSuffixes) {
                if (originalName.includes(suffix)) {
                    const suffixIndex = originalName.indexOf(suffix);
                    baseName = originalName.substring(0, suffixIndex).trim();
                    preservedSuffix = ` ${suffix}`; 
                    break; 
                }
            }
            return baseName + preservedSuffix;
        };

        const processedItems = allMasterItemsRaw.map(item => ({ name: processItemName(item.name), unit: item.unit, price: item.price, sourceOriginal: item.company, sourceTranslated: translateCompanyToEnglish(item.company), status: "paid" }));
        const paidItems = processedItems;
        const nameIndex = new Map(); const companyIndex = new Map();
        
        paidItems.forEach(item => { nameIndex.set(item.name.toLowerCase(), item); const sourceKey = item.sourceTranslated || "Unknown Source"; if (!companyIndex.has(sourceKey)) companyIndex.set(sourceKey, new Set()); companyIndex.get(sourceKey).add(item); });

        function getJaroWinklerSimilarity(s1, s2) { let m = 0; const range = Math.floor(Math.max(s1.length, s2.length) / 2) - 1; const s1Matches = new Array(s1.length).fill(false); const s2Matches = new Array(s2.length).fill(false); for (let i=0; i<s1.length; i++) { const low=Math.max(0,i-range); const high=Math.min(i+range+1,s2.length); for (let j=low; j<high; j++) { if (!s2Matches[j] && s1[i]===s2[j]) {s1Matches[i]=true; s2Matches[j]=true; m++; break;}}} if (m===0) return 0; let k=0, t=0; for (let i=0; i<s1.length; i++) { if (s1Matches[i]) { while(!s2Matches[k]) k++; if (s1[i]!==s2[k]) t++; k++;}} const jaro = (m/s1.length + m/s2.length + (m-t/2)/m)/3; let p=0; const l=Math.min(4,Math.min(s1.length,s2.length)); for (let i=0; i<l; i++) { if (s1[i]===s2[i]) p++; else break;} return jaro + p * 0.1 * (1 - jaro); }

        function findSimilarTerms(searchTerm, N = 3) {
            const lowerSearchTerm = searchTerm.toLowerCase();
            const scoredSuggestions = paidItems.map(item => {
                const lowerName = item.name.toLowerCase();
                const jaroWinkler = getJaroWinklerSimilarity(lowerSearchTerm, lowerName);
                let score = jaroWinkler;
                if (lowerName.startsWith(lowerSearchTerm)) score += 0.2;
                return { name: item.name, score };
            }).filter(s => s.score > 0.75 && s.name.toLowerCase() !== lowerSearchTerm)
              .sort((a, b) => b.score - a.score);
            return [...new Set(scoredSuggestions.map(s => s.name))].slice(0, N);
        }
        
        function displaySuggestions(suggestedTerms) { suggestionsArea.innerHTML = ''; if (suggestedTerms.length > 0) { const p = document.createElement('p'); const strong = document.createElement('strong'); strong.textContent = 'Did you mean:'; p.appendChild(strong); suggestedTerms.forEach((term) => { const a = document.createElement('a'); a.href = '#'; a.textContent = term; a.addEventListener('click', (e) => { e.preventDefault(); searchInput.value = term; performSearchAndFilter(); }); p.appendChild(a); }); suggestionsArea.appendChild(p); } }
        
        function populateFilters() {
            const units = [...new Set(paidItems.map(item => item.unit || "N/A"))].sort((a,b) => a.localeCompare(b));
            const sourcesTranslated = [...new Set(paidItems.map(item => item.sourceTranslated || "Unknown Source"))].sort((a,b) => a.localeCompare(b));
            unitFilterSelect.innerHTML = '<option value="all">All Units</option>';
            units.forEach(unit => { const option = document.createElement('option'); option.value = unit; option.textContent = unit; unitFilterSelect.appendChild(option);});
            companyFilterSelect.innerHTML = '<option value="all">All Sources</option>';
            sourcesTranslated.forEach(source => { const option = document.createElement('option'); option.value = source; option.textContent = source; companyFilterSelect.appendChild(option);});
        }

        function performSearchAndFilter() {
            const searchTerm = searchInput.value.trim().toLowerCase();
            const selectedUnit = unitFilterSelect.value;
            const selectedSourceTranslated = companyFilterSelect.value; 
            const searchTokens = searchTerm.split(/\s+/).filter(t => t.length > 0);

            let filtered = paidItems.filter(item => {
                const lowerName = item.name.toLowerCase();
                const matchesSearch = searchTokens.length > 0 ? searchTokens.every(token => lowerName.includes(token)) : true;
                const matchesUnit = (selectedUnit === 'all') || ((item.unit || "N/A") === selectedUnit);
                const matchesSource = (selectedSourceTranslated === 'all') || ((item.sourceTranslated || "Unknown Source") === selectedSourceTranslated);
                return matchesSearch && matchesUnit && matchesSource;
            });

            if (searchTerm) {
                filtered.sort((a,b) => {
                    const aName = a.name.toLowerCase(); const bName = b.name.toLowerCase();
                    const simA = getJaroWinklerSimilarity(searchTerm, aName); const simB = getJaroWinklerSimilarity(searchTerm, bName);
                    return simB - simA;
                });
            }
            renderResults(filtered);
            if (filtered.length === 0 && searchTerm.length >=3) { displaySuggestions(findSimilarTerms(searchTerm)); } 
            else { suggestionsArea.innerHTML = ''; }
        }

        function renderResults(itemsToRender) {
            resultsArea.innerHTML = '';
            const hasSearchTerm = searchInput.value.trim().length > 0;
            const hasActiveFilter = unitFilterSelect.value !== 'all' || companyFilterSelect.value !== 'all';

            if (itemsToRender.length === 0) {
                 if (hasSearchTerm || hasActiveFilter) {
                    resultsArea.innerHTML = `<p class="placeholder-text">No items found matching your criteria.</p>`;
                } else {
                    resultsArea.innerHTML = `<p class="placeholder-text">Begin your search to unveil the collection...</p>`;
                }
                return;
            }
            itemsToRender.forEach((item, index) => {
                const itemEl = document.createElement('div');
                itemEl.className = 'result-item';
                itemEl.style.animation = `fadeInMajestic 0.7s ease-out forwards ${index * 0.05}s`;

                itemEl.innerHTML = `
                    <div class="item-header">
                        <h3 class="item-name">${item.name}</h3>
                        <div class="item-details">
                            <p><strong>Unit:</strong> ${item.unit || 'N/A'}</p>
                            <p><strong>Source:</strong> <span class="source-arabic">${item.sourceOriginal || 'N/A'}</span></p>
                        </div>
                    </div>
                    <div class="item-price-wrapper">
                        <span class="price">${item.price ? item.price.toFixed(2) : 'N/A'}</span>
                    </div>
                `;
                resultsArea.appendChild(itemEl);
            });
        }

        searchInput.addEventListener('input', () => { clearTimeout(searchTimeout); searchTimeout = setTimeout(performSearchAndFilter, 300); });
        unitFilterSelect.addEventListener('change', performSearchAndFilter);
        companyFilterSelect.addEventListener('change', performSearchAndFilter);
        resetFiltersBtn.addEventListener('click', () => { 
            searchInput.value = ''; 
            unitFilterSelect.value = 'all'; 
            companyFilterSelect.value = 'all'; 
            suggestionsArea.innerHTML = ''; 
            resultsArea.innerHTML = '<p class="placeholder-text">Begin your search to unveil the collection...</p>';
        });

        populateFilters();
    });
    </script>
</html>
