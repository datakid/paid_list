<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LX Search p2.2</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@500&family=Cormorant+Garamond:ital,wght@0,400;0,500;0,600;1,400&family=Playfair+Display:wght@500;600&family=Prata&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
:root {
            --lx-gold: linear-gradient(135deg, #8b7355 0%, #b5956f 20%, #d4c4a8 40%, #c9b693 60%, #a6906b 80%, #8b7355 100%);
            --lx-gold-solid: #a6906b;
            --lx-gold-light: #c9b693;
            --lx-gold-dark: #7a6446;
            --lx-gold-text: linear-gradient(135deg, #f5f0e8 0%, #d4c4a8 25%, #b5956f 50%, #a6906b 75%, #8b7355 100%);
            --lx-gold-matte: #b5956f;
            --lx-gold-accent: rgba(181, 149, 111, 0.15);
            --lx-gold-subtle: rgba(166, 144, 107, 0.08);
            --lx-platinum: linear-gradient(135deg, #e8e8e8 0%, #d0d0d0 25%, #c5c5c5 50%, #d0d0d0 75%, #e8e8e8 100%);
            --lx-dark-bg: radial-gradient(ellipse at center, #0f0f0f 0%, #060606 50%, #020202 100%);
            --lx-element-bg: linear-gradient(145deg, #1a1a1a 0%, #0d0d0d 50%, #050505 100%);
            --lx-element-bg-hover: linear-gradient(145deg, #242424 0%, #151515 50%, #0a0a0a 100%);
            --lx-element-bg-active: linear-gradient(145deg, #2a2a2a 0%, #1b1b1b 50%, #0f0f0f 100%);
            --lx-text-light: #f8f8f8;
            --lx-text-medium: #e0e0e0;
            --lx-text-dark: #1a1a1a;
            --lx-text-placeholder: #888888;
            --lx-border-subtle: rgba(181, 149, 111, 0.12);
            --lx-border-defined: rgba(181, 149, 111, 0.25);
            --lx-reset-button-bg: linear-gradient(135deg, #3a3a3a 0%, #2a2a2a 50%, #1a1a1a 100%);
            --lx-reset-button-text: #d0d0d0;
            --lx-reset-button-border: #606060;

            --font-logo: 'Cinzel', serif;
            --font-display: 'Playfair Display', serif;
            --font-body: 'Cormorant Garamond', serif;
            --font-price: 'Prata', serif;
            --border-radius-main: 28px;
            --border-radius-elements: 32px;
            --shadow-refined: 0 20px 60px rgba(0,0,0, 0.4), 0 8px 24px rgba(0,0,0, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.03);
            --shadow-elevated: 0 32px 80px rgba(0,0,0, 0.5), 0 12px 32px rgba(0,0,0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.04);
            --shadow-supreme: 0 48px 120px rgba(0,0,0, 0.6), 0 20px 48px rgba(0,0,0, 0.4), inset 0 2px 0 rgba(255, 255, 255, 0.05);
            --shadow-inset-luxury: inset 0 2px 8px rgba(0,0,0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.05);
        }
        
        @keyframes fadeInLuxury {
            from { opacity: 0; transform: translateY(40px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        @keyframes fadeInMajestic {
            from { opacity: 0; transform: translateY(25px) scale(0.97); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        
        @keyframes subtlePulse {
            0% { border-color: var(--lx-gold-dark); }
            50% { border-color: var(--lx-gold-light); }
            100% { border-color: var(--lx-gold-dark); }
        }

        @keyframes elegantShimmer {
            0% { transform: translateX(-200%) skewX(-20deg); opacity: 0; }
            20% { opacity: 0.3; }
            80% { opacity: 0.3; }
            100% { transform: translateX(300%) skewX(-20deg); opacity: 0; }
        }

        @keyframes subtleFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-4px); }
        }

        @keyframes refinedBreathe {
            0%, 100% { transform: scale(1); opacity: 0.4; }
            50% { transform: scale(1.02); opacity: 0.6; }
        }

        body, html { 
            margin: 0; padding: 0; font-family: var(--font-body); background: var(--lx-dark-bg); color: var(--lx-text-light); min-height: 100vh; 
            overflow-x: hidden; font-size: 17px; line-height: 1.7; font-weight: 400; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; position: relative;
        }

        body::before { 
            content: ""; position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: 
                radial-gradient(circle at 20% 80%, rgba(166, 144, 107, 0.02) 0%, transparent 60%), 
                radial-gradient(circle at 80% 20%, rgba(181, 149, 111, 0.02) 0%, transparent 60%),
                linear-gradient(180deg, rgba(30, 30, 30, 0.01) 0%, transparent 100%);
            pointer-events: none; z-index: -1; 
        }
        
        body::after { 
            content: ""; position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: 
                repeating-linear-gradient(0deg, transparent, transparent 3px, rgba(181, 149, 111, 0.005) 3px, rgba(181, 149, 111, 0.005) 6px),
                repeating-linear-gradient(90deg, transparent, transparent 3px, rgba(166, 144, 107, 0.005) 3px, rgba(166, 144, 107, 0.005) 6px);
            pointer-events: none; z-index: -1; opacity: 0.3; 
        }

        .app-container { 
            width: 100%; max-width: 1200px; margin: 0 auto; padding: 60px 30px; min-height: 100vh; display: flex; flex-direction: column; 
            animation: fadeInLuxury 1.6s cubic-bezier(0.19, 1, 0.22, 1); 
        }
        
        .app-header { 
            background: var(--lx-element-bg); padding: 50px; border-radius: var(--border-radius-main); margin-bottom: 50px; 
            box-shadow: var(--shadow-elevated); border: 1px solid var(--lx-border-defined); position: relative; overflow: hidden; 
            backdrop-filter: blur(20px);
        }

        .app-header::before {
            content: ""; position: absolute; top: 0; left: -200%; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(245, 240, 232, 0.02) 25%, rgba(212, 196, 168, 0.03) 50%, rgba(245, 240, 232, 0.02) 75%, transparent);
            animation: elegantShimmer 12s infinite 3s;
        }

        .app-header::after { 
            content: ""; position: absolute; top: 0; left: 0; right: 0; height: 1px; 
            background: linear-gradient(90deg, transparent, var(--lx-gold-light) 25%, var(--lx-gold-solid) 50%, var(--lx-gold-light) 75%, transparent); 
            opacity: 0.3; 
        }
        
        .header-top { display: flex; justify-content: center; align-items: center; margin-bottom: 45px; position: relative; z-index: 1; }
        
        .logo { 
            font-family: var(--font-logo); font-size: 3.2em; font-weight: 500; 
            background: var(--lx-gold-text); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent; 
            letter-spacing: 3px; text-shadow: 0 0 30px rgba(166, 144, 107, 0.15); 
            animation: subtleFloat 15s ease-in-out infinite; position: relative; 
        }

        .logo::before { 
            content: ""; position: absolute; top: -20px; left: -20px; right: -20px; bottom: -20px; 
            background: radial-gradient(circle, rgba(166, 144, 107, 0.04) 0%, transparent 70%); 
            border-radius: 50%; animation: refinedBreathe 10s ease-in-out infinite; z-index: -1; 
        }
        
        .logo i.fa-gem { 
            font-size: 0.85em; color: var(--lx-gold-solid); 
            filter: drop-shadow(0 0 8px rgba(166, 144, 107, 0.3)); 
            animation: subtleFloat 15s ease-in-out infinite reverse;
            position: absolute; right: 100%; top: 50%; transform: translateY(-50%); margin-right: 25px;
        }

        .search-wrapper { position: relative; width: 100%; max-width: 750px; margin: 0 auto 40px auto; }
        
        .shortcut-key {
            position: absolute; right: 30px; top: 50%; transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.03); color: var(--lx-text-placeholder);
            border: 1px solid rgba(255, 255, 255, 0.12); border-radius: 10px;
            padding: 6px 14px; font-size: 0.9em;
            font-family: Menlo, Monaco, Consolas, "Courier New", monospace;
            line-height: 1; pointer-events: none;
            transition: all 0.5s cubic-bezier(0.19, 1, 0.22, 1);
            opacity: 0.4; z-index: 2;
        }

        #searchInput:focus ~ .shortcut-key,
        #searchInput:not(:placeholder-shown) ~ .shortcut-key {
            opacity: 0; transform: translateY(-50%) scale(0.85);
        }

        #searchInput { 
            width: 100%; padding: 24px 90px 24px 70px; font-size: 1.25em; 
            font-family: var(--font-body); font-weight: 500; 
            border: 2px solid var(--lx-gold-dark); border-radius: var(--border-radius-elements); 
            background: var(--lx-element-bg); color: var(--lx-text-light); outline: none; 
            transition: all 0.6s cubic-bezier(0.19, 1, 0.22, 1);
            box-shadow: var(--shadow-inset-luxury), 0 12px 36px rgba(0,0,0,0.4); 
            position: relative; z-index: 1; backdrop-filter: blur(15px); box-sizing: border-box;
        }

        #searchInput:focus { 
            animation: subtlePulse 6s infinite ease-in-out; 
            background: var(--lx-element-bg-hover); 
            transform: scale(1.015); 
            box-shadow: var(--shadow-inset-luxury), 0 16px 48px rgba(0,0,0,0.5), 0 0 0 1px var(--lx-border-defined);
        }
        
        #searchInput::placeholder { color: var(--lx-text-placeholder); font-weight: 400; font-style: italic; opacity: 0.8; }
        
        .search-icon { 
            position: absolute; left: 30px; top: 50%; transform: translateY(-50%); 
            color: var(--lx-text-placeholder); font-size: 1.4em; pointer-events: none; 
            transition: all 0.6s ease; z-index: 2; 
        }
        
        #searchInput:focus + .search-icon { 
            color: var(--lx-gold-solid); 
            filter: drop-shadow(0 0 6px rgba(166, 144, 107, 0.4)); 
            transform: translateY(-50%) scale(1.08); 
        }

        .filter-area { display: flex; gap: 20px; flex-wrap: wrap; justify-content: center; position: relative; z-index: 1; }

        .filter-select, .filter-btn-reset { 
            background: var(--lx-gold); border: 1px solid var(--lx-gold-dark); color: var(--lx-text-dark); 
            padding: 14px 32px; border-radius: var(--border-radius-elements); cursor: pointer;
            font-size: 1.05em; font-weight: 600; font-family: var(--font-body); 
            transition: all 0.6s cubic-bezier(0.19, 1, 0.22, 1);
            box-shadow: 0 10px 24px rgba(0,0,0,0.25), var(--shadow-inset-luxury);
            letter-spacing: 0.8px; display: flex; align-items: center; position: relative; overflow: hidden; 
            backdrop-filter: blur(8px);
        }

        .filter-select::before, .filter-btn-reset::before {
            content: ""; position: absolute; top: 0; left: -150%; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1) 25%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.1) 75%, transparent);
            transition: left 1s ease;
        }

        .filter-select:hover::before, .filter-btn-reset:hover::before { left: 150%; }
        
        .filter-select { appearance: none; -webkit-appearance: none; -moz-appearance: none; padding-right: 55px; }
        
        .filter-select::after { 
            content: '\f078'; font-family: 'Font Awesome 6 Free'; font-weight: 900; font-size: 0.85em; 
            position: absolute; right: 24px; color: var(--lx-text-dark); 
            transition: transform 0.5s ease; pointer-events: none; 
        }
        
        .filter-select:focus::after { transform: rotate(180deg); }
        
        .filter-select option { 
            background: #2e2e2e; color: var(--lx-gold-light); font-weight: 500; padding: 14px; 
            border-radius: 10px; font-family: var(--font-body); 
        }

        .filter-select:hover, .filter-btn-reset:hover { 
            transform: translateY(-6px); 
            box-shadow: 0 20px 48px rgba(0,0,0,0.35), var(--shadow-inset-luxury), 0 0 0 1px rgba(255, 255, 255, 0.1);
            filter: brightness(1.08) saturate(1.05); border-color: var(--lx-gold-light);
        }

        .filter-btn-reset { 
            background: var(--lx-reset-button-bg); color: var(--lx-reset-button-text); 
            border: 1px solid var(--lx-reset-button-border); 
        }
        
        .filter-btn-reset:hover { 
            background: linear-gradient(135deg, #4e4e4e 0%, #3e3e3e 50%, #2e2e2e 100%); 
            color: var(--lx-text-light); border-color: #888888; 
        }
        
        .app-main { flex-grow: 1; position: relative; padding-top: 30px; }

        .suggestions-area { 
            margin: 0 auto 40px auto; max-width: calc(100% - 60px); width: fit-content; 
            padding: 22px 30px; background: var(--lx-element-bg); border-radius: 20px; 
            border: 1px solid var(--lx-border-defined); font-size: 1.1em; color: var(--lx-text-placeholder); 
            text-align: left; box-shadow: var(--shadow-refined); animation: fadeInLuxury 0.8s ease-out; 
            position: relative; overflow: hidden; backdrop-filter: blur(12px);
        }
        
        .suggestions-area::before { 
            content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 1px; 
            background: linear-gradient(90deg, transparent, var(--lx-gold-light) 15%, var(--lx-gold-solid) 50%, var(--lx-gold-light) 85%, transparent); 
            opacity: 0.4; 
        }
        
        .suggestions-area:empty { display: none; }
        .suggestions-area p { margin: 0; display: flex; align-items: center; flex-wrap: wrap; gap: 8px 12px; }
        .suggestions-area strong { font-weight: 600; color: var(--lx-text-medium); margin-right: 10px; font-style: italic; }
        
        .suggestions-area a { 
            color: var(--lx-gold-solid); text-decoration: none; font-weight: 600; 
            padding: 5px 12px; border-radius: 8px; transition: all 0.5s ease; 
            display: inline-block; border: 1px solid transparent; position: relative; overflow: hidden; z-index: 1; 
        }
        
        .suggestions-area a::before { 
            content: ""; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; 
            background: var(--lx-gold); transition: left 0.5s ease; z-index: -1; 
        }
        
        .suggestions-area a:hover::before { left: 0; }
        
        .suggestions-area a:hover { 
            color: var(--lx-text-dark); text-decoration: none; border-color: rgba(255, 255, 255, 0.15); 
            box-shadow: 0 6px 16px rgba(166, 144, 107, 0.25); transform: translateY(-2px);
        }
        
        .results-area { display: grid; grid-template-columns: repeat(auto-fill, minmax(360px, 1fr)); gap: 40px; }
        .results-area .placeholder-text { 
            color: var(--lx-text-placeholder); text-align: center; font-size: 1.3em; margin-top: 100px; 
            grid-column: 1 / -1; font-weight: 400; font-style: italic; opacity: 0.5; 
        }
        
        .result-item {
            background: var(--lx-element-bg); border: 1px solid var(--lx-border-defined); 
            border-radius: 22px; padding: 35px; box-shadow: var(--shadow-refined);
            transition: all 0.7s cubic-bezier(0.19, 1, 0.22, 1); position: relative; overflow: hidden; 
            display: flex; flex-direction: column; justify-content: space-between; backdrop-filter: blur(15px);
        }

        .result-item::before { 
            content: ""; position: absolute; top: -60%; left: -300%; width: 100%; height: 220%; 
            background: linear-gradient(60deg, transparent 0%, rgba(245, 240, 232, 0.02) 15%, rgba(212, 196, 168, 0.04) 50%, rgba(245, 240, 232, 0.02) 85%, transparent 100%); 
            transform: skewX(-20deg); transition: left 2s cubic-bezier(0.165, 0.84, 0.44, 1); opacity: 0; z-index: 1; 
        }
        
        .result-item::after { 
            content: ""; position: absolute; top: 0; left: 0; right: 0; bottom: 0; 
            background: linear-gradient(135deg, rgba(166, 144, 107, 0.03) 0%, transparent 60%); 
            opacity: 0; transition: opacity 0.7s ease; z-index: 0; 
        }
        
        .result-item:hover::before { left: 200%; opacity: 0.8; transition-duration: 2.5s; }
        .result-item:hover::after { opacity: 1; }
        
        .result-item:hover { 
            transform: translateY(-16px); box-shadow: var(--shadow-supreme); 
            border-color: var(--lx-gold-solid); background: var(--lx-element-bg-hover); 
        }
        
        .item-header { margin-bottom: 20px; z-index: 2; position: relative; flex-grow: 1; }
        
        .item-name { 
            font-family: var(--font-display); font-size: 1.9em; font-weight: 600; 
            background: var(--lx-gold-text); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent; 
            margin-bottom: 15px; line-height: 1.3; text-shadow: 0 0 15px rgba(166, 144, 107, 0.15); 
        }
        
        .item-details { 
            font-size: 1.05em; color: var(--lx-text-placeholder); font-weight: 500; z-index: 2; 
            position: relative; line-height: 1.7; 
        }
        
        .item-details strong { color: var(--lx-text-medium); font-weight: 600; }
        .item-details p { margin: 0 0 10px 0; }
        .item-details .source-arabic { font-family: 'Arial', sans-serif; }

        .item-price-wrapper { margin-top: 25px; text-align: right; z-index: 2; position: relative; }
        
        .price { 
            font-family: var(--font-price); font-weight: 400; 
            background: var(--lx-gold-text); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent; 
            font-size: 2.6em; text-shadow: 0 0 20px rgba(166, 144, 107, 0.2); letter-spacing: 1.5px; 
        }

        @media (max-width: 768px) { 
            .app-container { padding: 40px 25px; } 
            .app-header { padding: 35px 30px; margin-bottom: 35px; } 
            .logo { font-size: 2.6em; letter-spacing: 2px; } 
            #searchInput { padding: 20px 85px 20px 60px; font-size: 1.15em;} 
            .results-area { grid-template-columns: 1fr; gap: 35px;} 
            .item-name { font-size: 1.8em; } 
            .price { font-size: 2.4em; }
        }

        @media (max-width: 480px) { 
            .logo { font-size: 2.2em; letter-spacing: 1.8px; } 
            .filter-select, .filter-btn-reset { width: 100%; text-align: left; justify-content: space-between; } 
            .filter-select { padding-right: 30px; } 
            .filter-select::after { right: 20px; } 
            .item-name { font-size: 1.7em; } 
            .price { font-size: 2.2em; }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header class="app-header">
            <div class="header-top">
                <div class="logo">
                    <i class="fas fa-gem"></i>LX Search p2.2
                </div>
            </div>
            <div class="search-wrapper">
                 <input type="text" id="searchInput" placeholder="Search elite items...">
                 <i class="fas fa-search search-icon"></i>
                 <kbd class="shortcut-key">/</kbd>
            </div>
            <div class="filter-area">
                <select id="unitFilter" class="filter-select">
                    <option value="all">All Units</option>
                </select>
                <select id="companyFilter" class="filter-select">
                    <option value="all">All Sources</option>
                </select>
                 <button id="resetFilters" class="filter-btn-reset">Reset Filters</button>
            </div>
        </header>

        <main class="app-main">
            <div id="suggestionsArea" class="suggestions-area"></div>
            <div id="resultsArea" class="results-area">
                <p class="placeholder-text">Start typing to explore the LX Paid collection...</p>
            </div>
        </main>
    </div>
</body>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        if ('scrollRestoration' in history) {
            history.scrollRestoration = 'manual';
        }

        const searchInput = document.getElementById('searchInput');
        const unitFilterSelect = document.getElementById('unitFilter');
        const companyFilterSelect = document.getElementById('companyFilter');
        const resetFiltersBtn = document.getElementById('resetFilters');
        const resultsArea = document.getElementById('resultsArea');
        const suggestionsArea = document.getElementById('suggestionsArea');
        let searchTimeout;

        const allMasterItemsRaw = [
            {name: "Amaryl 1", unit: "30 Tab", price: 11.5, company: "شراء موحد"}, {name: "Amaryl 2", unit: "30 Tab", price: 27, company: "شراء موحد"}, {name: "Amaryl 3", unit: "30 Tab", price: 30, company: "شراء موحد"}, {name: "Amaryl 4", unit: "30 Tab", price: 37.5, company: "شراء موحد"}, {name: "Amaryl M", unit: "30 Tab", price: 26.5, company: "شراء موحد"}, {name: "Apidra قوي عاملة", unit: "Penfill", price: 44, company: "شراء موحد"}, {name: "Apidra طلاب", unit: "Penfill", price: 20, company: "شراء موحد"}, {name: "Atacand 16", unit: "14 Tab", price: 38.5, company: "شراء موحد"}, {name: "Atacand 16 plus", unit: "14 Tab", price: 42, company: "شراء موحد"}, {name: "Atacand 8", unit: "14 Tab", price: 27, company: "شراء موحد"}, {name: "Atozet 10 / 10", unit: "10 Tab", price: 96, company: "شراء موحد"}, {name: "Atozet 20 / 10", unit: "10 Tab", price: 110, company: "شراء موحد"}, {name: "Brilique 60", unit: "56 Tab", price: 100, company: "ايرادات هيئة"}, {name: "Brilique 90", unit: "56 Tab", price: 100, company: "ايرادات هيئة"}, {name: "Campto", unit: "Vial", price: 60, company: "شراء موحد"}, {name: "Cardura 1", unit: "21 Tab", price: 23, company: "شراء موحد"}, {name: "Cardura 4", unit: "14 Tab", price: 31, company: "شراء موحد"}, {name: "Carnvita forte", unit: "30 Tab", price: 20, company: "شراء موحد"}, {name: "Celebrex 200", unit: "10 Tab", price: 51.5, company: "شراء موحد"}, {name: "Concor 2.5", unit: "30 Tab", price: 10, company: "شراء موحد"}, {name: "Concor 5", unit: "30 Tab", price: 26, company: "شراء موحد"}, {name: "Cosopt", unit: "Bottle", price: 52, company: "شراء موحد"}, {name: "Coveram 10 /10", unit: "15 Tab", price: 65, company: "شراء موحد"}, {name: "Coveram 5 / 5", unit: "15 Tab", price: 48, company: "شراء موحد"}, {name: "Coversyl 10 plus", unit: "15 Tab", price: 20, company: "شراء موحد"}, {name: "Coversyl 5", unit: "30 Tab", price: 53, company: "شراء موحد"}, {name: "Coversyl 5 plus", unit: "15 Tab", price: 30.5, company: "شراء موحد"}, {name: "Cozaar 50", unit: "7 Tab", price: 22.25, company: "شراء موحد"}, {name: "Crestor 10", unit: "28 Tab", price: 118, company: "شراء موحد"}, {name: "Crestor 20", unit: "14 Tab", price: 96, company: "شراء موحد"}, {name: "Crestor 5", unit: "7 Tab", price: 18, company: "شراء موحد"}, {name: "Daflon 500", unit: "30 Tab", price: 30, company: "شراء موحد"}, {name: "Daivobet", unit: "Tube", price: 20, company: "شراء موحد"}, {name: "Depakine Ch 500", unit: "30 Tab", price: 45, company: "شراء موحد"}, {name: "Depakine Syrup", unit: "Bottle", price: 16, company: "شراء موحد"}, {name: "Diamicron 30 Mr", unit: "30 Tab", price: 16, company: "شراء موحد"}, {name: "Diamicron 60 Mr", unit: "30 Tab", price: 20, company: "شراء موحد"}, {name: "Diamicron 80", unit: "20 Tab", price: 9, company: "شراء موحد"}, {name: "Dorofen", unit: "30 Cap", price: 10, company: "شراء موحد"}, {name: "Dostinex", unit: "2 Tab", price: 54.25, company: "شراء موحد"}, {name: "Eliquis 2.5", unit: "20 Tab", price: 50, company: "ايرادات هيئة"}, {name: "Eliquis 5", unit: "20 Tab", price: 50, company: "ايرادات هيئة"}, {name: "Eloxatin 100", unit: "Vial", price: 800, company: "شراء موحد"}, {name: "Eloxatin 50", unit: "Vial", price: 500, company: "شراء موحد"}, {name: "Entresto 100", unit: "28 Tab", price: 50, company: "ايرادات هيئة"}, {name: "Entresto 200", unit: "28 Tab", price: 50, company: "ايرادات هيئة"}, {name: "Entresto 50", unit: "28 Tab", price: 50, company: "ايرادات هيئة"}, {name: "Etodolac 600", unit: "10 Tab", price: 15.5, company: "شراء موحد"}, {name: "Exforge Hct 160 / 10 / 25", unit: "14 Tab", price: 70.5, company: "شراء موحد"}, {name: "Exforge Hct 160 / 5 /12.5", unit: "14 Tab", price: 73.5, company: "شراء موحد"}, {name: "Femara 2.5", unit: "30 Tab", price: 52.59, company: "شراء موحد"}, {name: "Flagyl 250", unit: "20 Tab", price: 5.5, company: "شراء موحد"}, {name: "Foradil", unit: "30 Cap", price: 75, company: "شراء موحد"}, {name: "Forxiga 10", unit: "28 Tab", price: 222, company: "شراء موحد"}, {name: "Forxiga 5", unit: "28 Tab", price: 234, company: "شراء موحد"}, {name: "Galvus 50", unit: "28 Tab", price: 65, company: "شراء موحد"}, {name: "Galvus Met 50 / 1000", unit: "30 Tab", price: 86.5, company: "شراء موحد"}, {name: "Galvus Met 50 / 850", unit: "30 Tab", price: 79.5, company: "شراء موحد"}, {name: "Genuphil", unit: "50 Tab", price: 20, company: "شراء موحد"}, {name: "Glucophage 1000", unit: "30 Tab", price: 12.5, company: "شراء موحد"}, {name: "Glucophage 500", unit: "50 Tab", price: 14.5, company: "شراء موحد"}, {name: "Glucophage Xr 1000", unit: "30 Tab", price: 42.5, company: "شراء موحد"}, {name: "Glucovance 5 / 500", unit: "30 Tab", price: 26.5, company: "شراء موحد"}, {name: "Glucovance 5 /1000", unit: "30 Tab", price: 20, company: "شراء موحد"}, {name: "Humalog 100 pen قوي عاملة", unit: "Pen", price: 52.87, company: "شراء موحد"}, {name: "Humalog 100 penfill قوي عاملة", unit: "Penfill", price: 48, company: "شراء موحد"}, {name: "Humalog Mix 25 قوي عاملة", unit: "Pen", price: 60, company: "شراء موحد"}, {name: "Humalog Mix 25 طلاب", unit: "Pen", price: 20, company: "شراء موحد"}, {name: "Humalog Mix 50 قوي عاملة", unit: "Pen", price: 60, company: "شراء موحد"}, {name: "Humalog Mix 50 طلاب", unit: "Pen", price: 20, company: "شراء موحد"}, {name: "Hyzaar 50", unit: "7 Tab", price: 22, company: "شراء موحد"}, {name: "Isoptin 80", unit: "30 Tab", price: 6.5, company: "شراء موحد"}, {name: "Januvia 100", unit: "28 Tab", price: 193, company: "شراء موحد"}, {name: "Januvia 50", unit: "28 Tab", price: 165, company: "شراء موحد"}, {name: "Jaunamet 50 / 1000", unit: "56 Tab", price: 195, company: "شراء موحد"}, {name: "Jaunamet 50 / 500", unit: "56 Tab", price: 204, company: "شراء موحد"}, {name: "Jaunamet 50 / 850", unit: "56 Tab", price: 175, company: "شراء موحد"}, {name: "Lasilactone 50 / 20", unit: "30 Tab", price: 8, company: "شراء موحد"}, {name: "Lantus", unit: "Penfill", price: 20, company: "ايرادات هيئة"}, {name: "Lasix 40", unit: "24 Tab", price: 9, company: "شراء موحد"}, {name: "Lipanthyl 300", unit: "30 Tab", price: 26, company: "شراء موحد"}, {name: "Lipitor 10", unit: "7 Tab", price: 28.5, company: "شراء موحد"}, {name: "Lipitor 20", unit: "7 Tab", price: 32, company: "شراء موحد"}, {name: "Lipitor 40", unit: "7 Tab", price: 46.5, company: "شراء موحد"}, {name: "Lipiror 80", unit: "7 Tab", price: 51, company: "شراء موحد"}, {name: "Lustral 50", unit: "7 Tab", price: 26.5, company: "شراء موحد"}, {name: "Mena Q", unit: "20 Cap", price: 37, company: "شراء موحد"}, {name: "Methyltechno", unit: "30 Film", price: 12, company: "شراء موحد"}, {name: "Natrilix Sr", unit: "30 Tab", price: 16, company: "شراء موحد"}, {name: "Natrixam 1.5 / 10", unit: "28 Tab", price: 43, company: "شراء موحد"}, {name: "Natrixam 1.5 / 5", unit: "28 Tab", price: 43, company: "شراء موحد"}, {name: "Nebicard 5", unit: "14 Tab", price: 13, company: "شراء موحد"}, {name: "Nexium 20", unit: "28 Tab", price: 140, company: "شراء موحد"}, {name: "Norditropine", unit: "Pen", price: 30, company: "شراء موحد"}, {name: "Norvasc 10", unit: "10 Tab", price: 25.5, company: "شراء موحد"}, {name: "Norvasc 5", unit: "10 Tab", price: 23.5, company: "شراء موحد"}, {name: "Novomix 30 Mix قوي عاملة", unit: "Pen", price: 60, company: "شراء موحد"}, {name: "Novomix 30 Mix طلاب", unit: "Pen", price: 20, company: "شراء موحد"}, {name: "Novomix 50 Mix قوي عاملة", unit: "Pen", price: 60, company: "شراء موحد"}, {name: "Novomix 50 Mix طلاب", unit: "Pen", price: 20, company: "شراء موحد"}, {name: "Novorapid قوي عاملة", unit: "Penfill", price: 39.5, company: "شراء موحد"}, {name: "Novorapid طلاب", unit: "Penfill", price: 20, company: "شراء موحد"}, {name: "Orthoglobe", unit: "30 Tab", price: 10, company: "شراء موحد"}, {name: "Plavix 75", unit: "28 Tab", price: 40, company: "ايرادات هيئة"}, {name: "Plendil 5", unit: "30 Tab", price: 33, company: "شراء موحد"}, {name: "Pletaal 100", unit: "20 Tab", price: 64, company: "شراء موحد"}, {name: "Pletaal 50", unit: "20 Tab", price: 44.5, company: "شراء موحد"}, {name: "Procorolan 5", unit: "28 Tab", price: 50, company: "شراء موحد"}, {name: "Procorolan 7.5", unit: "28 Tab", price: 50, company: "شراء موحد"}, {name: "Ryzodec", unit: "Pen", price: 100, company: "شراء موحد"}, {name: "Singulair 10", unit: "14 Tab", price: 84.5, company: "شراء موحد"}, {name: "Singulair 5", unit: "14 Tab", price: 77.75, company: "شراء موحد"}, {name: "Soliqua 100 / 33", unit: "Pen", price: 162, company: "شراء موحد"}, {name: "Soliqua 100 / 50", unit: "Pen", price: 287, company: "شراء موحد"}, {name: "Tareg 40", unit: "15 Tab", price: 49, company: "شراء موحد"}, {name: "Tarolimus", unit: "Tube", price: 15, company: "شراء موحد"}, {name: "Taxoter 20", unit: "Vial", price: 240, company: "شراء موحد"}, {name: "Taxoter 80", unit: "Vial", price: 860, company: "شراء موحد"}, {name: "Tegretol 200", unit: "30 Tab", price: 13, company: "شراء موحد"}, {name: "Tegretol 200 Cr", unit: "20 Tab", price: 7.5, company: "شراء موحد"}, {name: "Tegretol 400 Cr", unit: "20 Tab", price: 9, company: "شراء موحد"}, {name: "Tenormin 100", unit: "14 Tab", price: 9.5, company: "شراء موحد"}, {name: "Tenormin 50", unit: "14 Tab", price: 7.25, company: "شراء موحد"}, {name: "Tentavair 160", unit: "Spray", price: 27, company: "شراء موحد"}, {name: "Toujeo قوي عاملة", unit: "Pen", price: 50, company: "شراء موحد"}, {name: "Toujeo طلاب", unit: "Pen", price: 15, company: "شراء موحد"}, {name: "Tresiba قوي عاملة", unit: "Pen", price: 70, company: "شراء موحد"}, {name: "Tresiba طلاب", unit: "Pen", price: 25, company: "شراء موحد"}, {name: "Trilepital 300", unit: "50 Tab", price: 116.25, company: "شراء موحد"}, {name: "Tritace 2.5", unit: "14 Tab", price: 14.5, company: "شراء موحد"}, {name: "Tritace 5", unit: "14 Tab", price: 19, company: "شراء موحد"}, {name: "Tritace comp 5 / 25", unit: "14 Tab", price: 27, company: "شراء موحد"}, {name: "Tritace Comp Ls 2.5 / 12.5", unit: "14 Tab", price: 18, company: "شراء موحد"}, {name: "Tritace Protect 10", unit: "20 Tab", price: 29, company: "شراء موحد"}, {name: "Trivastal", unit: "30 Tab", price: 27.25, company: "شراء موحد"}, {name: "Vastarel Mr", unit: "30 Tab", price: 48.5, company: "شراء موحد"}, {name: "Xarelto 10", unit: "10 Tab", price: 50, company: "ايرادات هيئة"}, {name: "Xarelto 15", unit: "42 Tab", price: 210, company: "ايرادات هيئة"}, {name: "Xarelto 20", unit: "28 Tab", price: 140, company: "ايرادات هيئة"}, {name: "Xigduo 5 /1000", unit: "56 Tab", price: 98.5, company: "شراء موحد"}, {name: "Zestril 5", unit: "10 Tab", price: 6.25, company: "شراء موحد"}, {name: "Zestril 10", unit: "10 Tab", price: 7.5, company: "شراء موحد"}, {name: "Zestril 20", unit: "10 Tab", price: 8.5, company: "شراء موحد"}, {name: "Zocor 10", unit: "7 Tab", price: 22.75, company: "شراء موحد"}, {name: "Zocor 20", unit: "14 Tab", price: 60.5, company: "شراء موحد"}, {name: "Zocor 40", unit: "14 Tab", price: 57, company: "شراء موحد"}
        ];

        const preserveSuffixes = ["قوي عاملة", "طلاب"]; 

        const translateCompanyToEnglish = (arabicCompany) => {
            if (arabicCompany === "شراء موحد") return "Unified Purchase";
            if (arabicCompany === "ايرادات هيئة") return "Authority Revenue";
            return arabicCompany; 
        };
        
        const processItemName = (originalName) => {
            let baseName = originalName;
            let preservedSuffix = "";
            for (const suffix of preserveSuffixes) {
                if (originalName.includes(suffix)) {
                    const suffixIndex = originalName.indexOf(suffix);
                    baseName = originalName.substring(0, suffixIndex).trim();
                    preservedSuffix = ` ${suffix}`; 
                    break; 
                }
            }
            return baseName + preservedSuffix;
        };

        const paidItems = allMasterItemsRaw.map(item => ({
            name: processItemName(item.name),
            unit: item.unit, 
            price: item.price,
            sourceOriginal: item.company, 
            sourceTranslated: translateCompanyToEnglish(item.company), 
        }));
        
        const levenshteinDistance = (a, b) => {
            if (a.length === 0) return b.length;
            if (b.length === 0) return a.length;
            const matrix = Array.from(Array(a.length + 1), () => Array(b.length + 1).fill(0));
            for (let i = 0; i <= a.length; i++) matrix[i][0] = i;
            for (let j = 0; j <= b.length; j++) matrix[0][j] = j;
            for (let i = 1; i <= a.length; i++) {
                for (let j = 1; j <= b.length; j++) {
                    const cost = a[i - 1] === b[j - 1] ? 0 : 1;
                    matrix[i][j] = Math.min(
                        matrix[i - 1][j] + 1,      // Deletion
                        matrix[i][j - 1] + 1,      // Insertion
                        matrix[i - 1][j - 1] + cost // Substitution
                    );
                }
            }
            return matrix[a.length][b.length];
        };

        function findAndRenderSuggestions(searchTerm) {
            const suggestions = paidItems.map(item => {
                    const distance = levenshteinDistance(searchTerm, item.name.toLowerCase());
                    return { ...item, distance };
                })
                .sort((a, b) => a.distance - b.distance);

            const threshold = searchTerm.length > 5 ? 3 : 2;
            const bestMatches = suggestions.filter(item => item.distance <= threshold).slice(0, 5);

            if (bestMatches.length > 0) {
                const suggestionsHTML = bestMatches.map(item => `<a href="#">${item.name}</a>`).join('');
                suggestionsArea.innerHTML = `<p><strong>Did you mean:</strong> ${suggestionsHTML}</p>`;
            }
        }


        function performSearchAndFilter() {
            suggestionsArea.innerHTML = ''; // Clear suggestions on every search
            const searchTerm = searchInput.value.trim().toLowerCase();
            const selectedUnit = unitFilterSelect.value;
            const selectedSourceTranslated = companyFilterSelect.value; 

            let filtered = paidItems.filter(item => {
                const lowerName = item.name.toLowerCase();
                const matchesSearch = searchTerm ? lowerName.includes(searchTerm) : true;
                const matchesUnit = (selectedUnit === 'all') || (item.unit === selectedUnit);
                const matchesSource = (selectedSourceTranslated === 'all') || (item.sourceTranslated === selectedSourceTranslated);
                return matchesSearch && matchesUnit && matchesSource;
            });
            
            if (filtered.length === 0 && searchTerm.length > 2) {
                findAndRenderSuggestions(searchTerm);
            }

            renderResults(filtered);
        }

        function renderResults(itemsToRender) {
            resultsArea.innerHTML = '';
            const hasSearchTerm = searchInput.value.trim().length > 0;
            const hasActiveFilter = unitFilterSelect.value !== 'all' || companyFilterSelect.value !== 'all';

            if (itemsToRender.length === 0) {
                 // Only show the "No items found" message if there are no suggestions either
                 if ((hasSearchTerm || hasActiveFilter) && suggestionsArea.innerHTML === '') {
                    resultsArea.innerHTML = `<p class="placeholder-text">No items found matching your criteria.</p>`;
                } else if (!hasSearchTerm && !hasActiveFilter) {
                    resultsArea.innerHTML = `<p class="placeholder-text">Start typing to explore the LX Paid collection...</p>`;
                }
                return;
            }

            itemsToRender.forEach((item, index) => {
                const itemEl = document.createElement('div');
                itemEl.className = 'result-item';
                itemEl.style.opacity = 0;
                itemEl.style.animation = `fadeInMajestic 0.7s ease-out forwards ${index * 0.05}s`;

                itemEl.innerHTML = `
                    <div class="item-header">
                        <h3 class="item-name">${item.name}</h3>
                        <div class="item-details">
                            <p><strong>Unit:</strong> ${item.unit || 'N/A'}</p>
                            <p><strong>Source:</strong> <span class="source-arabic">${item.sourceOriginal || 'N/A'}</span></p>
                        </div>
                    </div>
                    <div class="item-price-wrapper">
                        <span class="price">${item.price ? item.price.toFixed(2) : 'N/A'}</span>
                    </div>
                `;
                resultsArea.appendChild(itemEl);
            });
        }
        
        function populateFilters() {
            const units = [...new Set(paidItems.map(item => item.unit || "N/A"))].sort((a,b) => a.localeCompare(b));
            const sourcesTranslated = [...new Set(paidItems.map(item => item.sourceTranslated || "Unknown Source"))].sort((a,b) => a.localeCompare(b));
            
            unitFilterSelect.innerHTML = '<option value="all">All Units</option>';
            units.forEach(unit => { const option = document.createElement('option'); option.value = unit; option.textContent = unit; unitFilterSelect.appendChild(option);});
            
            companyFilterSelect.innerHTML = '<option value="all">All Sources</option>';
            sourcesTranslated.forEach(source => { const option = document.createElement('option'); option.value = source; option.textContent = source; companyFilterSelect.appendChild(option);});
        }

        searchInput.addEventListener('input', () => { clearTimeout(searchTimeout); searchTimeout = setTimeout(performSearchAndFilter, 300); });
        unitFilterSelect.addEventListener('change', performSearchAndFilter);
        companyFilterSelect.addEventListener('change', performSearchAndFilter);
        resetFiltersBtn.addEventListener('click', () => { 
            searchInput.value = ''; 
            unitFilterSelect.value = 'all'; 
            companyFilterSelect.value = 'all'; 
            suggestionsArea.innerHTML = ''; 
            performSearchAndFilter();
        });

        suggestionsArea.addEventListener('click', e => {
            if (e.target.tagName === 'A' && e.target.closest('.suggestions-area')) {
                e.preventDefault();
                searchInput.value = e.target.textContent;
                performSearchAndFilter();
                searchInput.focus();
            }
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === '/' && document.activeElement.tagName.toLowerCase() !== 'input' && document.activeElement.tagName.toLowerCase() !== 'select') {
                e.preventDefault();
                window.scrollTo({ top: 0, left: 0 });
                searchInput.focus();
            }
        });

        populateFilters();
        performSearchAndFilter(); 
    });
    </script>
</html>
